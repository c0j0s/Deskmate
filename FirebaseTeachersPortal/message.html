<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Messages</title>
	<link rel="stylesheet" type = "text/css" href="css/bootstrap-grid.css">
	<link rel="stylesheet" type = "text/css" href="css/bootstrap-reboot.css">
	<link rel="stylesheet" type = "text/css" href="css/bootstrap.css">
	<link rel="stylesheet" type = "text/css" href="css/styling.css">
	<script src="js/jquery.js"></script>
	<script src="js/bootstrap.js"></script>
	

	<script src="https://www.gstatic.com/firebasejs/5.0.4/firebase.js"></script>


  </head>
  <body>
  <nav>
		<div class="container" id="nav-content">
			<div id="nav-pic">
				<a href="index.html">
					<img src="..\Deskmate AndroidApp\app\src\main\res\mipmap-mdpi\ic_launcher.png"/>
				</a>
			</div>
			<ul class="nav nav-pills">
				<li class="nav-item">
					<a class="nav-link" href="index.html">
						Home
					</a>
				</li>
				<li class="nav-item">
					<a class="nav-link active" href="message.html">
						Messages
					</a>
				</li>
			</ul>
		</div>
	</nav>
	<div class="content"></div>
	<div class="container">
		<div id="content">
			
		</div>
	</div>
    <script>
        
        //The Firebase SDK is initialized and available here!
		 var config = {
			apiKey: "AIzaSyB29exuhOXpePNSnW4UaGd8dhSppgYbYTo",
			authDomain: "deskmate2018.firebaseapp.com",
			databaseURL: "https://deskmate2018.firebaseio.com",
			projectId: "deskmate2018",
			storageBucket: "deskmate2018.appspot.com",
			messagingSenderId: "876434687063"
		};
		firebase.initializeApp(config);
		var messageDb = firebase.database().ref('messages');
		messageDb.once('value', getmessage)
		var studentnameDb;
		var value;
		function getmessage(message){
			message.forEach(function(msgsnapshot){
			value = msgsnapshot.val().replyTo;
				console.log(value);
				if(value === "" || value === undefined){
					$('<div class="card bg-light mb-3"><div class="card-header">Name: '+msgsnapshot.val().senderName+'</div><div class="card-body" data-msg="s'+msgsnapshot.key+'" id="s'+msgsnapshot.key+'"><div id="'+msgsnapshot.key+'"><div class="card-text"><p>From: '+msgsnapshot.val().senderName+'</p><p>To: '+msgsnapshot.val().recipientName+'</p><br><p>'+msgsnapshot.val().message+'</p><br><p>'+msgsnapshot.val().datetime+'</p></div><hr></div></div></div>').prependTo('#content');
				}else if(value != "" && value == $(this).data("msg")){
					$('<div id="'+msgsnapshot.key+'"><div class="card-text"><p>From: '+msgsnapshot.val().senderName+'</p><p>To: '+msgsnapshot.val().recipientName+'</p><br><p>'+msgsnapshot.val().message+'</p><br><p>'+msgsnapshot.val().datetime+'</p></div><hr></div>').prependTo('#s'+value);
				}
				else{
				$('<div id="'+msgsnapshot.key+'"><div class="card-text"><p>From: '+msgsnapshot.val().senderName+'</p><p>To: '+msgsnapshot.val().recipientName+'</p><br><p>'+msgsnapshot.val().message+'</p><br><p>'+msgsnapshot.val().datetime+'</p></div><hr></div>').prependTo('#'+value)
				}
			})
		}
		
		<!-- function writetoDB(){ -->
		<!-- papername = document.getElementById('pName').value; -->
			<!-- firebase.database().ref('messages/').push({ -->
				<!-- datetime:, -->
				<!-- from:, -->
				<!-- message:, -->
				<!-- read: false, -->
				<!-- recipientName:, -->
				<!-- replyTo:, -->
				<!-- senderName:, -->
				<!-- to:, -->
			<!-- }) -->
			<!-- } -->
    </script>
  </body>
</html>
